controller:
  httpsKeyStore:
    enable: false
  ingress:
    enabled: true
    apiVersion: "networking.k8s.io/v1"
    hostName: jenkins.34.55.201.151.sslip.io
    annotations:
      kubernetes.io/ingress.class: nginx
      cert-manager.io/cluster-issuer: letsencrypt-prod
    tls:
     - secretName: jenkins-tls
       hosts:
         - jenkins.34.55.201.151.sslip.io

agent:
  enabled: true
  podTemplates:
    stackgen-runner: |
      - name: stackgen-runner
        label: stackgen
        serviceAccount: jenkins
        volumes:
          - secretVolume:
              secretName: gcp-sa-key
              mountPath: /var/secrets/google
        containers:
          - name: stackgen
            image: gcr.io/leander-test-471809/jenkins-stackgen-runner:latest
            ttyEnabled: true
            command: cat
            securityContext:
              runAsUser: 1000
              runAsNonRoot: true
              allowPrivilegeEscalation: false
            envVars:
              - secretEnvVar:
                  key: STACKGEN_API_TOKEN
                  secretName: stackgen-api-token
                  secretKey: STACKGEN_API_TOKEN
              - envVar:
                  key: GOOGLE_APPLICATION_CREDENTIALS
                  value: /var/secrets/google/key.json
              - envVar:
                  key: DEBIAN_FRONTEND
                  value: noninteractive
